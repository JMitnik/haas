# Migration `20200612141902-added-question-node-to-triggers-relation`

This migration has been generated by Cold-A-Muse at 6/12/2020, 2:19:02 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."Trigger" ADD COLUMN "relatedNodeId" text   ;

ALTER TABLE "public"."Trigger" ADD FOREIGN KEY ("relatedNodeId")REFERENCES "public"."QuestionNode"("id") ON DELETE SET NULL  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200612093907-init..20200612141902-added-question-node-to-triggers-relation
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource postgresql {
   provider = "postgresql"
-  url = "***"
+  url      = env("DB_STRING")
 }
 // binaryTargets = ["debian-openssl-1.1.x"]
 generator client {
@@ -93,8 +93,9 @@
   isRelatedNodeOfNodeEntries NodeEntry[]
   edgeId                     String?
   Edge                       Edge?            @relation("EdgeChildrenRelation", fields: [edgeId], references: [id])
   QuestionOption             QuestionOption[] @relation("QuestionNodeOptions")
+  triggers                   Trigger[]
 }
 model Edge {
   childNodeId                String
@@ -234,6 +235,9 @@
   name       String
   type       TriggerType
   medium     TriggerMedium
   conditions TriggerCondition[]
+  relatedNodeId String?
+  relatedNode QuestionNode? @relation(fields: [relatedNodeId], references: [id])
   recipients User[]
+  // TODO: Add dialogue ID (?)
 }
```


