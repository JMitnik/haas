# Migration `20210701135303-make-dialogue-optional-on-postleafnode`

This migration has been generated by Daan at 7/1/2021, 3:53:03 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."Dialogue" DROP COLUMN "language",
ADD COLUMN "postLeafNodeId" text   

ALTER TABLE "public"."QuestionOption" ADD COLUMN "position" integer   

ALTER TABLE "public"."SliderNode" ADD COLUMN "unhappyText" text   ,
ADD COLUMN "happyText" text   

DROP TYPE "LanguageEnum"

CREATE TABLE "public"."PostLeafNode" (
"id" text   NOT NULL ,
"header" text   NOT NULL ,
"subtext" text   NOT NULL ,
PRIMARY KEY ("id")
)

CREATE UNIQUE INDEX "Dialogue_postLeafNodeId_unique" ON "public"."Dialogue"("postLeafNodeId")

ALTER TABLE "public"."Dialogue" ADD FOREIGN KEY ("postLeafNodeId")REFERENCES "public"."PostLeafNode"("id") ON DELETE SET NULL ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20210630083542-post-leaf-node..20210701135303-make-dialogue-optional-on-postleafnode
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource postgresql {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 // binaryTargets = ["debian-openssl-1.1.x"]
 generator client {
@@ -83,9 +83,9 @@
   id      String @id @default(cuid())
   header  String
   subtext String
-  Dialogue Dialogue[]
+  Dialogue Dialogue?
 }
 model Dialogue {
   id             String         @id @default(cuid())
@@ -330,8 +330,10 @@
   question   QuestionNode? @relation("QuestionNodeOptions", fields: [questionId], references: [id])
   questionNodeId String?
   QuestionNode   QuestionNode? @relation(fields: [questionNodeId], references: [id])
+
+  position Int?
 }
 model Session {
   createdAt   DateTime    @default(now())
```


