# Migration `20200605110548-added-customer-permissions-n-m-relation`

This migration has been generated by Cold-A-Muse at 6/5/2020, 11:05:48 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."Permission" ADD COLUMN "customerId" text   ;

ALTER TABLE "public"."Permission" ADD FOREIGN KEY ("customerId")REFERENCES "public"."Customer"("id") ON DELETE SET NULL  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200605105852-made-role-permission-relation-many-to-many..20200605110548-added-customer-permissions-n-m-relation
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource postgresql {
   provider = "postgresql"
-  url = "***"
+  url      = env("DB_STRING")
 }
 // binaryTargets = ["debian-openssl-1.1.x"]
 generator client {
@@ -48,15 +48,16 @@
   customer         Customer?       @relation(fields: [customerId], references: [id])
 }
 model Customer {
-  id        String            @default(cuid()) @id
-  slug      String            @unique
-  name      String
-  settings  CustomerSettings?
-  dialogues Dialogue[]
-  users     User[]
-  roles     Role[]
+  id          String            @default(cuid()) @id
+  slug        String            @unique
+  name        String
+  settings    CustomerSettings?
+  dialogues   Dialogue[]
+  users       User[]
+  roles       Role[]
+  permissions Permission[]
 }
 model Dialogue {
   creationDate DateTime       @default(now())
@@ -164,12 +165,14 @@
   NodeEntry              NodeEntry?       @relation(fields: [nodeEntryId], references: [id])
 }
 model Permission {
-  id          String  @default(cuid()) @id
+  id          String    @default(cuid()) @id
   name        String
   description String?
-  Role        Role[]  @relation(references: [id])
+  Role        Role[]    @relation(references: [id])
+  Customer    Customer? @relation(fields: [customerId], references: [id])
+  customerId  String?
 }
 model Role {
   id          String       @default(cuid()) @id
```


