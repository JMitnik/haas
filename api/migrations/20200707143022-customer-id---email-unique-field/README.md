# Migration `20200707143022-customer-id---email-unique-field`

This migration has been generated by Cold-A-Muse at 7/7/2020, 2:30:22 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
DROP INDEX "public"."User.email"

CREATE UNIQUE INDEX "User.customerId_email" ON "public"."User"("customerId","email")
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200629055605-init..20200707143022-customer-id---email-unique-field
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource postgresql {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 // binaryTargets = ["debian-openssl-1.1.x"]
 generator client {
@@ -208,17 +208,18 @@
 model User {
   id         String    @default(cuid()) @id
   createdAt  DateTime  @default(now())
   updatedAt  DateTime? @updatedAt
-  email      String    @unique
+  email      String    
   phone      String?
   firstName  String?
   lastName   String?
   roleId     String
   role       Role      @relation(fields: [roleId], references: [id])
   Customer   Customer? @relation(fields: [customerId], references: [id])
   customerId String?
   triggers   Trigger[] @relation(references: [id])
+  @@unique([customerId, email])
 }
 enum TriggerType {
   QUESTION
```


