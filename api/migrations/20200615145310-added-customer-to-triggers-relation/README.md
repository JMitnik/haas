# Migration `20200615145310-added-customer-to-triggers-relation`

This migration has been generated by Cold-A-Muse at 6/15/2020, 2:53:10 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."Trigger" ADD COLUMN "customerId" text   ;

ALTER TABLE "public"."Trigger" ADD FOREIGN KEY ("customerId")REFERENCES "public"."Customer"("id") ON DELETE SET NULL  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200612141902-added-question-node-to-triggers-relation..20200615145310-added-customer-to-triggers-relation
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource postgresql {
   provider = "postgresql"
-  url = "***"
+  url      = env("DB_STRING")
 }
 // binaryTargets = ["debian-openssl-1.1.x"]
 generator client {
@@ -56,8 +56,9 @@
   dialogues   Dialogue[]
   users       User[]
   roles       Role[]
   permissions Permission[]
+  triggers    Trigger[]
 }
 model Dialogue {
   creationDate DateTime       @default(now())
@@ -230,14 +231,16 @@
   triggerId String?
 }
 model Trigger {
-  id         String             @default(cuid()) @id
-  name       String
-  type       TriggerType
-  medium     TriggerMedium
-  conditions TriggerCondition[]
+  id            String             @default(cuid()) @id
+  name          String
+  type          TriggerType
+  medium        TriggerMedium
+  conditions    TriggerCondition[]
   relatedNodeId String?
-  relatedNode QuestionNode? @relation(fields: [relatedNodeId], references: [id])
-  recipients User[]
+  relatedNode   QuestionNode?      @relation(fields: [relatedNodeId], references: [id])
+  recipients    User[]
   // TODO: Add dialogue ID (?)
+  Customer      Customer?          @relation(fields: [customerId], references: [id])
+  customerId    String?
 }
```


